(this["webpackJsonpreact-practice"]=this["webpackJsonpreact-practice"]||[]).push([[6],{575:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));var r=n(22),a=n.n(r),c=function(e,t){return a.a.post("/users/my-cart",{productId:e,size:t,qty:1})},o=function(e){return a.a.delete("/users/my-cart/".concat(e))},i=function(e){return a.a.get("/products/".concat(e))}},592:function(e,t,n){"use strict";n.r(t);var r=n(32),a=n(147);var c=n(13),o=n(1),i=n(30),s=n(22),u=n.n(s),l=n(17),d=n(566),f=n(2);var p=function(){return Object(f.jsxs)("div",{className:"img-notify cart",children:[Object(f.jsx)("div",{className:"img-notify__img",children:Object(f.jsx)("img",{src:"/images/empty-cart.svg",alt:""})}),Object(f.jsxs)("div",{className:"img-notify__text",children:[Object(f.jsx)("h1",{children:"Empty Cart"}),Object(f.jsx)("p",{children:"Your cart is sad because it\u2019s feeling so lonely :("}),Object(f.jsx)(d.a,{to:"/",variant:"contained",size:"large",style:{background:"#f37256",color:"#fff"},component:l.b,children:"Go Home"})]})]})},j=n(73),m=n(74),b=n(131),y=n(93),h=n(65),v=n.n(h),x=n(94),g="https://js.stripe.com/v3",O=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,w="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",S=null,k=function(e){return null!==S?S:S=new Promise((function(t,n){if("undefined"!==typeof window)if(window.Stripe&&e&&console.warn(w),window.Stripe)t(window.Stripe);else try{var r=function(){for(var e=document.querySelectorAll('script[src^="'.concat(g,'"]')),t=0;t<e.length;t++){var n=e[t];if(O.test(n.src))return n}return null}();r&&e?console.warn(w):r||(r=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(g).concat(t);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(n),n}(e)),r.addEventListener("load",(function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))})),r.addEventListener("error",(function(){n(new Error("Failed to load Stripe.js"))}))}catch(a){return void n(a)}else t(null)}))},C=function(e,t,n){if(null===e)return null;var r=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"1.15.0",startTime:t})}(r,n),r},_=Promise.resolve().then((function(){return k(null)})),E=!1;_.catch((function(e){E||console.warn(e)}));var I=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];E=!0;var r=Date.now();return _.then((function(e){return C(e,t,r)}))}("pk_test_51ITHCBF1Ikr3hcxKaG1RteN9KpssC8rFAXKy1xLattO8xWVyGOXr6jT156VTKztkGox8JcKptiEUlIhxuT9R49HA00dfcXjX5f");var T=function(e){var t=e.totalAmount,n=Object(o.useContext)(i.a).appDispatch,r=function(){var e=Object(x.a)(v.a.mark((function e(){var t,r,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"processing",payload:!0}),e.next=3,I;case 3:return t=e.sent,e.next=6,u.a.post("/my-orders/checkout");case 6:return r=e.sent,e.next=9,t.redirectToCheckout({sessionId:r.data.session.id});case 9:(a=e.sent).error&&(alert(a.error.message),n({type:"processing",payload:!1}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(f.jsxs)("div",{className:"d-flex flex-column align-items-end cart-checkout",children:[Object(f.jsxs)("h3",{children:["Total amount: \u20b9",t.toLocaleString()]}),t>=1e3&&Object(f.jsx)("span",{style:{display:"inline-block",background:"#1eb11e",color:"#fff",borderRadius:"4px",padding:"0.25rem 0.5rem",margin:"0.5rem 0",fontSize:"0.8rem"},children:"Free Delivery available"}),Object(f.jsx)(d.a,{variant:"contained",color:"secondary",size:"large",onClick:r,style:{marginTop:"0.5rem"},children:"Checkout"})]})},N=n(575),A=n(255);t.default=function(){var e=Object(o.useContext)(i.a),t=e.appState,n=e.appDispatch,s=Object(o.useState)([]),l=Object(c.a)(s,2),d=l[0],h=l[1],v=Object(o.useState)(!0),x=Object(c.a)(v,2),g=x[0],O=x[1],w=Object(o.useState)(0),S=Object(c.a)(w,2),k=S[0],C=S[1];Object(o.useEffect)((function(){if(t.isLoggedIn){var e=u.a.CancelToken.source();return u.a.get("/users/my-cart",{cancelToken:e.token}).then((function(e){h(e.data.cart),O(!1)})).catch((function(e){O(!1)})),function(){return e.cancel()}}O(!1)}),[t.isLoggedIn]);var _=function(e,t){u.a.patch("/users/my-cart/".concat(e),{qty:t}).catch((function(e){alert(e.response.data.error)}));var n=d.map((function(n){return n.product._id==e&&(n.qty=t),n}));h(n)};Object(o.useEffect)((function(){d.length&&C(E(d))}),[d]);var E=function(e){var t,n=0,r=function(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Object(a.a)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,c=function(){};return{s:c,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}(e);try{for(r.s();!(t=r.n()).done;){var c=t.value;n+=c.product.currentPrice*c.qty}}catch(o){r.e(o)}finally{r.f()}return n},I=function(e){n({type:"processing",payload:!0}),Object(N.b)(e).then((function(t){var r=d.filter((function(t){return t.product._id!=e}));h(r),n({type:"updateCart",payload:t.data.cart})})).catch((function(e){alert(e.response.data.error)})).finally((function(){n({type:"processing",payload:!1})}))};return g?Object(f.jsx)(y.a,{}):Object(f.jsxs)(j.a,{title:"My Cart",children:[Object(f.jsx)(b.a,{}),Object(f.jsx)(m.a,{}),Object(f.jsx)("main",{children:d.length?Object(f.jsx)("section",{className:"my-cart",children:Object(f.jsxs)("div",{className:"my-cart__container",children:[Object(f.jsx)("header",{className:"text-center",children:Object(f.jsx)("h2",{children:"My Cart"})}),d.map((function(e){return Object(f.jsx)(A.a,Object(r.a)(Object(r.a)({},e),{},{changeItemQty:_,removeItem:I}),e._id)})),Object(f.jsx)("footer",{className:"d-flex justify-content-end",children:Object(f.jsx)(T,{totalAmount:k})})]})}):Object(f.jsx)(p,{})})]})}}}]);
//# sourceMappingURL=6.35050f82.chunk.js.map